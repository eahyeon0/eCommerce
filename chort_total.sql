SELECT FORMAT_TIMESTAMP('%Y-%m',users.created_at) AS cohort, FORMAT_TIMESTAMP('%Y-%m',orders.created_at) AS order_month, COUNT(DISTINCT orders.user_id) AS active_users, COUNT(orders.order_id) AS total_orders, SUM(order_items.sale_price) AS total_revenue FROM `bigquery-public-data.thelook_ecommerce.users` as users JOIN `bigquery-public-data.thelook_ecommerce.orders` as orders ON users.id = orders.user_id JOIN `bigquery-public-data.thelook_ecommerce.order_items` as order_items ON orders.order_id = order_items.order_id GROUP BY cohort, order_month ORDER BY cohort, order_month;